<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">

  <title>PSH SUP ‚Äì Vie du campus</title>

  <!-- Responsive -->
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- PWA -->
  <meta name="theme-color" content="#b23a2c">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="apple-mobile-web-app-title" content="PSH SUP">

  <!-- Manifest -->
  <link rel="manifest" href="/PSH-SUP/manifest.json">

  <!-- Icons -->
  <link rel="apple-touch-icon" href="/PSH-SUP/icons/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/PSH-SUP/icons/icon-192.png">
  <link rel="icon" type="image/png" sizes="512x512" href="/PSH-SUP/icons/icon-512.png">

  <!-- iOS Splash fix -->
  <meta name="apple-mobile-web-app-status-bar-style" content="black">

  <!-- Styles -->
  <link rel="stylesheet" href="style.css">
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
</head>

<body>

<header class="header">
  <h1>Contact</h1>
  <p>Une question ? Une absence ? Un justificatif ?</p>
</header>

<main class="page">
  <div class="card contact-card">

    <h2>‚úâÔ∏è Contacter la scolarit√©</h2>

    <form
      name="contact-psh"
      method="POST"
      action="/contact-success.html"
      data-netlify="true"
      netlify-honeypot="bot-field"
      enctype="multipart/form-data"
      class="contact-form"
    >

      <!-- Obligatoire Netlify -->
      <input type="hidden" name="form-name" value="contact-psh">

      <!-- Anti-spam -->
      <p hidden>
        <label>
          Ne pas remplir :
          <input name="bot-field">
        </label>
      </p>

      <div class="form-row">
        <div class="form-group">
          <label>Nom</label>
          <input type="text" name="nom" required>
        </div>

        <div class="form-group">
          <label>Pr√©nom</label>
          <input type="text" name="prenom" required>
        </div>
      </div>

      <div class="form-group">
        <label>Classe</label>
        <input type="text" name="classe" required>
      </div>

      <div class="form-group">
        <label>Email</label>
        <input type="email" name="email" required>
      </div>

      <div class="form-group">
        <label>Campus</label>
        <select name="campus" required>
          <option value="">Choisir un campus</option>
          <option value="117">117</option>
          <option value="Molitor">Molitor</option>
        </select>
      </div>

      <div class="form-group">
        <label>Objet</label>
        <select name="objet" id="objet" required>
          <option value="">Choisir un objet</option>
          <option value="Absence">Justifier une absence</option>
          <option value="Retard">Justifier un retard</option>
          <option value="Bourse">Notification conditionnelle de bourse</option>
          <option value="Autre">Autre demande</option>
        </select>
      </div>

      <div class="form-group">
        <label>Message</label>
        <textarea name="message" rows="4" required></textarea>
      </div>

      <div class="form-group" id="justificatifGroup" style="display:none;">
        <label>Justificatif (PDF / JPG / PNG)</label>
        <input
          type="file"
          name="justificatif"
          id="justificatif"
          accept=".pdf,.jpg,.jpeg,.png"
        >
      </div>

      <button type="submit" class="btn-primary">
        üì§ Envoyer
      </button>

    </form>

  </div>
</main>

<footer class="footer">
  ¬© PSH SUP ‚Äì Vie du campus ‚Äì 2026
</footer>

<script src="https://cdn.jsdelivr.net/npm/emailjs-com@3/dist/email.min.js"></script>

<script>
/* ===============================
   üìß EMAILJS INIT
=============================== */
(function () {
  emailjs.init("fHAZLsSL7znp1LTfF"); // ‚Üê remplace ici
})();

/* ===============================
   üì© ENVOI FORMULAIRE CONTACT
=============================== */
document.getElementById("contactForm").addEventListener("submit", function (e) {
  e.preventDefault();

  const msgBox = document.getElementById("contactMessage");
  msgBox.textContent = "";
  msgBox.style.color = "";

  const data = {
    nom: document.getElementById("nom").value.trim(),
    prenom: document.getElementById("prenom").value.trim(),
    classe: document.getElementById("classe").value.trim(),
    email: document.getElementById("email").value.trim(),
    campus: document.getElementById("campus").value,
    objet: document.getElementById("objet").value,
    message: document.getElementById("message").value.trim(),
    justificatif_url: "" // optionnel pour l‚Äôinstant
  };

  /* ‚úÖ VALIDATION */
  if (
    !data.nom ||
    !data.prenom ||
    !data.classe ||
    !data.email ||
    !data.campus ||
    !data.objet ||
    data.message.length < 5
  ) {
    msgBox.textContent = "‚ùå Merci de remplir tous les champs obligatoires.";
    msgBox.style.color = "#b23a2c";
    return;
  }

  msgBox.textContent = "‚è≥ Envoi du message...";
  msgBox.style.color = "#6b7280";

  emailjs
    .send(
      "scolaritepshsup",   // ‚Üê remplace ici
      "template_contact_pshsup",  // ‚Üê remplace ici
      data
    )
    .then(() => {
      msgBox.textContent = "‚úÖ Message envoy√© avec succ√®s.";
      msgBox.style.color = "green";
      e.target.reset();
    })
    .catch((error) => {
      console.error("EMAILJS ERROR:", error);
      msgBox.textContent = "‚ùå Erreur lors de l‚Äôenvoi du message.";
      msgBox.style.color = "#b23a2c";
    });
});
</script>


</body>
</html>
