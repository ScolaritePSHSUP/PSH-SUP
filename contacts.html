<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">

  <title>PSH SUP ‚Äì Vie du campus</title>

  <!-- Responsive -->
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- PWA -->
  <meta name="theme-color" content="#b23a2c">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="apple-mobile-web-app-title" content="PSH SUP">

  <!-- Manifest -->
  <link rel="manifest" href="/PSH-SUP/manifest.json">

  <!-- Icons -->
  <link rel="apple-touch-icon" href="/PSH-SUP/icons/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/PSH-SUP/icons/icon-192.png">
  <link rel="icon" type="image/png" sizes="512x512" href="/PSH-SUP/icons/icon-512.png">

  <!-- iOS Splash fix -->
  <meta name="apple-mobile-web-app-status-bar-style" content="black">

  <!-- Styles -->
  <link rel="stylesheet" href="style.css">
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

  
</head>

<body>

<header class="header">
  <h1>Contact</h1>
  <p>Une question ? Une absence ? Un justificatif ?</p>
</header>

<main class="page">
  <div class="card contact-card">

    <h2>‚úâÔ∏è Contacter la scolarit√©</h2>

<form id="contactForm" class="contact-form">

  <div class="form-row">
    <div class="form-group">
      <label>Nom</label>
      <input type="text" id="nom" required>
    </div>

    <div class="form-group">
      <label>Pr√©nom</label>
      <input type="text" id="prenom" required>
    </div>
  </div>

  <div class="form-group">
    <label>Classe</label>
    <input type="text" id="classe" required>
  </div>

  <div class="form-group">
    <label>Email</label>
    <input type="email" id="email" required>
  </div>

  <div class="form-group">
    <label>Objet</label>
    <select id="objet" required>
      <option value="">Choisir</option>
      <option value="Absence">Absence</option>
      <option value="Retard">Retard</option>
      <option value="Bourse">Bourse</option>
      <option value="Autre">Autre</option>
    </select>
  </div>

  <!-- ‚ö†Ô∏è Message conditionnel -->
  <p id="justificatifWarning" class="contact-warning" style="display:none;">
    üìé Pour toute <strong>absence</strong>, <strong>retard</strong> ou
    <strong>bourse</strong>, un justificatif est obligatoire.
  </p>

  <div class="form-group" id="justificatifGroup" style="display:none;">
    <label>Justificatif (PDF / JPG / PNG)</label>
    <input type="file" id="justificatif" accept=".pdf,.jpg,.jpeg,.png">
  </div>

  <div class="form-group">
    <label>Message</label>
    <textarea id="message" rows="4" required></textarea>
  </div>

  <button type="submit" class="btn-primary">
    üì§ Envoyer
  </button>

</form>


  </div>
</main>

<footer class="footer">
  ¬© PSH SUP ‚Äì Vie du campus ‚Äì 2026
</footer>


<script>
const form = document.getElementById("contactForm");
const objetSelect = document.getElementById("objet");
const justificatifGroup = document.getElementById("justificatifGroup");
const justificatifWarning = document.getElementById("justificatifWarning");

/* üéØ Affichage conditionnel PJ + message */
objetSelect.addEventListener("change", () => {
  const objetsAvecPJ = ["Absence", "Retard", "Bourse"];

  if (objetsAvecPJ.includes(objetSelect.value)) {
    justificatifGroup.style.display = "block";
    justificatifWarning.style.display = "block";
  } else {
    justificatifGroup.style.display = "none";
    justificatifWarning.style.display = "none";
    document.getElementById("justificatif").value = "";
  }
});

/* üìß Envoi mailto */
form.addEventListener("submit", (e) => {
  e.preventDefault();

  const nom = document.getElementById("nom").value.trim();
  const prenom = document.getElementById("prenom").value.trim();
  const classe = document.getElementById("classe").value.trim();
  const email = document.getElementById("email").value.trim();
  const objet = objetSelect.value;
  const message = document.getElementById("message").value.trim();
  const justificatif = document.getElementById("justificatif").files[0];

  if (!nom || !prenom || !classe || !email || !objet || message.length < 5) {
    alert("‚ùå Merci de remplir tous les champs.");
    return;
  }

  if (["Absence", "Retard", "Bourse"].includes(objet) && !justificatif) {
    alert("‚ùå Un justificatif est obligatoire pour cet objet.");
    return;
  }

  const subject = `[PSH SUP] ${objet} ‚Äì ${prenom} ${nom} ‚Äì ${classe}`;

  const body = `
Nom : ${nom}
Pr√©nom : ${prenom}
Classe : ${classe}
Email : ${email}

Objet : ${objet}

Message :
${message}

‚ö†Ô∏è Merci de joindre votre justificatif avant l‚Äôenvoi.
`;

  const mailto =
    "mailto:scolaritepshsup@passy-st-honore.com" +
    "?subject=" + encodeURIComponent(subject) +
    "&body=" + encodeURIComponent(body);

  window.location.href = mailto;
});

</script>




</body>
</html>
